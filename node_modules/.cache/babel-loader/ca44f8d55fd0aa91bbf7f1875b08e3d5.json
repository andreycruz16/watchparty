{"ast":null,"code":"'use strict'; //parse Empty Node as self closing node\n\nvar _defineProperty = require(\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\n\nvar buildFromOrderedJs = require('./orderedJs2Xml');\n\nvar defaultOptions = {\n  attributeNamePrefix: '@_',\n  attributesGroupName: false,\n  textNodeName: '#text',\n  ignoreAttributes: true,\n  cdataPropName: false,\n  format: false,\n  indentBy: '  ',\n  suppressEmptyNode: false,\n  suppressUnpairedNode: true,\n  suppressBooleanAttributes: true,\n  tagValueProcessor: function tagValueProcessor(key, a) {\n    return a;\n  },\n  attributeValueProcessor: function attributeValueProcessor(attrName, a) {\n    return a;\n  },\n  preserveOrder: false,\n  commentPropName: false,\n  unpairedTags: [],\n  entities: [{\n    regex: new RegExp(\"&\", \"g\"),\n    val: \"&amp;\"\n  }, //it must be on top\n  {\n    regex: new RegExp(\">\", \"g\"),\n    val: \"&gt;\"\n  }, {\n    regex: new RegExp(\"<\", \"g\"),\n    val: \"&lt;\"\n  }, {\n    regex: new RegExp(\"\\'\", \"g\"),\n    val: \"&apos;\"\n  }, {\n    regex: new RegExp(\"\\\"\", \"g\"),\n    val: \"&quot;\"\n  }],\n  processEntities: true,\n  stopNodes: []\n};\n\nfunction Builder(options) {\n  this.options = Object.assign({}, defaultOptions, options);\n\n  if (this.options.ignoreAttributes || this.options.attributesGroupName) {\n    this.isAttribute = function\n      /*a*/\n    () {\n      return false;\n    };\n  } else {\n    this.attrPrefixLen = this.options.attributeNamePrefix.length;\n    this.isAttribute = isAttribute;\n  }\n\n  this.processTextOrObjNode = processTextOrObjNode;\n\n  if (this.options.format) {\n    this.indentate = indentate;\n    this.tagEndChar = '>\\n';\n    this.newLine = '\\n';\n  } else {\n    this.indentate = function () {\n      return '';\n    };\n\n    this.tagEndChar = '>';\n    this.newLine = '';\n  }\n\n  if (this.options.suppressEmptyNode) {\n    this.buildTextNode = buildEmptyTextNode;\n    this.buildObjNode = buildEmptyObjNode;\n  } else {\n    this.buildTextNode = buildTextValNode;\n    this.buildObjNode = buildObjectNode;\n  }\n\n  this.buildTextValNode = buildTextValNode;\n  this.buildObjectNode = buildObjectNode;\n  this.replaceEntitiesValue = replaceEntitiesValue;\n  this.buildAttrPairStr = buildAttrPairStr;\n}\n\nBuilder.prototype.build = function (jObj) {\n  if (this.options.preserveOrder) {\n    return buildFromOrderedJs(jObj, this.options);\n  } else {\n    if (Array.isArray(jObj) && this.options.arrayNodeName && this.options.arrayNodeName.length > 1) {\n      jObj = _defineProperty({}, this.options.arrayNodeName, jObj);\n    }\n\n    return this.j2x(jObj, 0).val;\n  }\n};\n\nBuilder.prototype.j2x = function (jObj, level) {\n  var attrStr = '';\n  var val = '';\n\n  for (var key in jObj) {\n    if (typeof jObj[key] === 'undefined') {// supress undefined node\n    } else if (jObj[key] === null) {\n      if (key[0] === \"?\") val += this.indentate(level) + '<' + key + '?' + this.tagEndChar;else val += this.indentate(level) + '<' + key + '/' + this.tagEndChar; // val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\n    } else if (jObj[key] instanceof Date) {\n      val += this.buildTextNode(jObj[key], key, '', level);\n    } else if (typeof jObj[key] !== 'object') {\n      //premitive type\n      var attr = this.isAttribute(key);\n\n      if (attr) {\n        attrStr += this.buildAttrPairStr(attr, '' + jObj[key]);\n      } else {\n        //tag value\n        if (key === this.options.textNodeName) {\n          var newval = this.options.tagValueProcessor(key, '' + jObj[key]);\n          val += this.replaceEntitiesValue(newval);\n        } else {\n          val += this.buildTextNode(jObj[key], key, '', level);\n        }\n      }\n    } else if (Array.isArray(jObj[key])) {\n      //repeated nodes\n      var arrLen = jObj[key].length;\n\n      for (var j = 0; j < arrLen; j++) {\n        var item = jObj[key][j];\n\n        if (typeof item === 'undefined') {// supress undefined node\n        } else if (item === null) {\n          if (key[0] === \"?\") val += this.indentate(level) + '<' + key + '?' + this.tagEndChar;else val += this.indentate(level) + '<' + key + '/' + this.tagEndChar; // val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\n        } else if (typeof item === 'object') {\n          val += this.processTextOrObjNode(item, key, level);\n        } else {\n          val += this.buildTextNode(item, key, '', level);\n        }\n      }\n    } else {\n      //nested node\n      if (this.options.attributesGroupName && key === this.options.attributesGroupName) {\n        var Ks = Object.keys(jObj[key]);\n        var L = Ks.length;\n\n        for (var _j = 0; _j < L; _j++) {\n          attrStr += this.buildAttrPairStr(Ks[_j], '' + jObj[key][Ks[_j]]);\n        }\n      } else {\n        val += this.processTextOrObjNode(jObj[key], key, level);\n      }\n    }\n  }\n\n  return {\n    attrStr: attrStr,\n    val: val\n  };\n};\n\nfunction buildAttrPairStr(attrName, val) {\n  val = this.options.attributeValueProcessor(attrName, '' + val);\n  val = this.replaceEntitiesValue(val);\n\n  if (this.options.suppressBooleanAttributes && val === \"true\") {\n    return ' ' + attrName;\n  } else return ' ' + attrName + '=\"' + val + '\"';\n}\n\nfunction processTextOrObjNode(object, key, level) {\n  var result = this.j2x(object, level + 1);\n\n  if (object[this.options.textNodeName] !== undefined && Object.keys(object).length === 1) {\n    return this.buildTextNode(result.val, key, result.attrStr, level);\n  } else {\n    return this.buildObjNode(result.val, key, result.attrStr, level);\n  }\n}\n\nfunction buildObjectNode(val, key, attrStr, level) {\n  var tagEndExp = '</' + key + this.tagEndChar;\n  var piClosingChar = \"\";\n\n  if (key[0] === \"?\") {\n    piClosingChar = \"?\";\n    tagEndExp = \"\";\n  }\n\n  if (attrStr && val.indexOf('<') === -1) {\n    return this.indentate(level) + '<' + key + attrStr + piClosingChar + '>' + val + tagEndExp;\n  } else {\n    return this.indentate(level) + '<' + key + attrStr + piClosingChar + this.tagEndChar + val + this.indentate(level) + tagEndExp;\n  }\n}\n\nfunction buildEmptyObjNode(val, key, attrStr, level) {\n  if (val !== '') {\n    return this.buildObjectNode(val, key, attrStr, level);\n  } else {\n    if (key[0] === \"?\") return this.indentate(level) + '<' + key + attrStr + '?' + this.tagEndChar;else return this.indentate(level) + '<' + key + attrStr + '/' + this.tagEndChar;\n  }\n}\n\nfunction buildTextValNode(val, key, attrStr, level) {\n  var textValue = this.replaceEntitiesValue(val);\n\n  if (textValue === '' && this.options.unpairedTags.indexOf(key) !== -1) {\n    //unpaired\n    if (this.options.suppressUnpairedNode) {\n      return this.indentate(level) + '<' + key + this.tagEndChar;\n    } else {\n      return this.indentate(level) + '<' + key + \"/\" + this.tagEndChar;\n    }\n  } else {\n    return this.indentate(level) + '<' + key + attrStr + '>' + textValue + '</' + key + this.tagEndChar;\n  }\n}\n\nfunction replaceEntitiesValue(textValue) {\n  if (textValue && textValue.length > 0 && this.options.processEntities) {\n    for (var i = 0; i < this.options.entities.length; i++) {\n      var entity = this.options.entities[i];\n      textValue = textValue.replace(entity.regex, entity.val);\n    }\n  }\n\n  return textValue;\n}\n\nfunction buildEmptyTextNode(val, key, attrStr, level) {\n  if (val === '' && this.options.unpairedTags.indexOf(key) !== -1) {\n    //unpaired\n    if (this.options.suppressUnpairedNode) {\n      return this.indentate(level) + '<' + key + this.tagEndChar;\n    } else {\n      return this.indentate(level) + '<' + key + \"/\" + this.tagEndChar;\n    }\n  } else if (val !== '') {\n    //empty\n    return this.buildTextValNode(val, key, attrStr, level);\n  } else {\n    if (key[0] === \"?\") return this.indentate(level) + '<' + key + attrStr + '?' + this.tagEndChar; //PI tag\n    else return this.indentate(level) + '<' + key + attrStr + '/' + this.tagEndChar; //normal\n  }\n}\n\nfunction indentate(level) {\n  return this.options.indentBy.repeat(level);\n}\n\nfunction isAttribute(name\n/*, options*/\n) {\n  if (name.startsWith(this.options.attributeNamePrefix)) {\n    return name.substr(this.attrPrefixLen);\n  } else {\n    return false;\n  }\n}\n\nmodule.exports = Builder;","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/node_modules/fast-xml-parser/src/xmlbuilder/json2xml.js"],"names":["buildFromOrderedJs","require","defaultOptions","attributeNamePrefix","attributesGroupName","textNodeName","ignoreAttributes","cdataPropName","format","indentBy","suppressEmptyNode","suppressUnpairedNode","suppressBooleanAttributes","tagValueProcessor","key","a","attributeValueProcessor","attrName","preserveOrder","commentPropName","unpairedTags","entities","regex","RegExp","val","processEntities","stopNodes","Builder","options","Object","assign","isAttribute","attrPrefixLen","length","processTextOrObjNode","indentate","tagEndChar","newLine","buildTextNode","buildEmptyTextNode","buildObjNode","buildEmptyObjNode","buildTextValNode","buildObjectNode","replaceEntitiesValue","buildAttrPairStr","prototype","build","jObj","Array","isArray","arrayNodeName","j2x","level","attrStr","Date","attr","newval","arrLen","j","item","Ks","keys","L","object","result","undefined","tagEndExp","piClosingChar","indexOf","textValue","i","entity","replace","repeat","name","startsWith","substr","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n//parse Empty Node as self closing node\nconst buildFromOrderedJs = require('./orderedJs2Xml');\n\nconst defaultOptions = {\n  attributeNamePrefix: '@_',\n  attributesGroupName: false,\n  textNodeName: '#text',\n  ignoreAttributes: true,\n  cdataPropName: false,\n  format: false,\n  indentBy: '  ',\n  suppressEmptyNode: false,\n  suppressUnpairedNode: true,\n  suppressBooleanAttributes: true,\n  tagValueProcessor: function(key, a) {\n    return a;\n  },\n  attributeValueProcessor: function(attrName, a) {\n    return a;\n  },\n  preserveOrder: false,\n  commentPropName: false,\n  unpairedTags: [],\n  entities: [\n    { regex: new RegExp(\"&\", \"g\"), val: \"&amp;\" },//it must be on top\n    { regex: new RegExp(\">\", \"g\"), val: \"&gt;\" },\n    { regex: new RegExp(\"<\", \"g\"), val: \"&lt;\" },\n    { regex: new RegExp(\"\\'\", \"g\"), val: \"&apos;\" },\n    { regex: new RegExp(\"\\\"\", \"g\"), val: \"&quot;\" }\n  ],\n  processEntities: true,\n  stopNodes: []\n};\n\nfunction Builder(options) {\n  this.options = Object.assign({}, defaultOptions, options);\n  if (this.options.ignoreAttributes || this.options.attributesGroupName) {\n    this.isAttribute = function(/*a*/) {\n      return false;\n    };\n  } else {\n    this.attrPrefixLen = this.options.attributeNamePrefix.length;\n    this.isAttribute = isAttribute;\n  }\n\n  this.processTextOrObjNode = processTextOrObjNode\n\n  if (this.options.format) {\n    this.indentate = indentate;\n    this.tagEndChar = '>\\n';\n    this.newLine = '\\n';\n  } else {\n    this.indentate = function() {\n      return '';\n    };\n    this.tagEndChar = '>';\n    this.newLine = '';\n  }\n\n  if (this.options.suppressEmptyNode) {\n    this.buildTextNode = buildEmptyTextNode;\n    this.buildObjNode = buildEmptyObjNode;\n  } else {\n    this.buildTextNode = buildTextValNode;\n    this.buildObjNode = buildObjectNode;\n  }\n\n  this.buildTextValNode = buildTextValNode;\n  this.buildObjectNode = buildObjectNode;\n\n  this.replaceEntitiesValue = replaceEntitiesValue;\n  this.buildAttrPairStr = buildAttrPairStr;\n}\n\nBuilder.prototype.build = function(jObj) {\n  if(this.options.preserveOrder){\n    return buildFromOrderedJs(jObj, this.options);\n  }else {\n    if(Array.isArray(jObj) && this.options.arrayNodeName && this.options.arrayNodeName.length > 1){\n      jObj = {\n        [this.options.arrayNodeName] : jObj\n      }\n    }\n    return this.j2x(jObj, 0).val;\n  }\n};\n\nBuilder.prototype.j2x = function(jObj, level) {\n  let attrStr = '';\n  let val = '';\n  for (let key in jObj) {\n    if (typeof jObj[key] === 'undefined') {\n      // supress undefined node\n    } else if (jObj[key] === null) {\n      if(key[0] === \"?\") val += this.indentate(level) + '<' + key + '?' + this.tagEndChar;\n      else val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\n      // val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\n    } else if (jObj[key] instanceof Date) {\n      val += this.buildTextNode(jObj[key], key, '', level);\n    } else if (typeof jObj[key] !== 'object') {\n      //premitive type\n      const attr = this.isAttribute(key);\n      if (attr) {\n        attrStr += this.buildAttrPairStr(attr, '' + jObj[key]);\n      }else {\n        //tag value\n        if (key === this.options.textNodeName) {\n          let newval = this.options.tagValueProcessor(key, '' + jObj[key]);\n          val += this.replaceEntitiesValue(newval);\n        } else {\n          val += this.buildTextNode(jObj[key], key, '', level);\n        }\n      }\n    } else if (Array.isArray(jObj[key])) {\n      //repeated nodes\n      const arrLen = jObj[key].length;\n      for (let j = 0; j < arrLen; j++) {\n        const item = jObj[key][j];\n        if (typeof item === 'undefined') {\n          // supress undefined node\n        } else if (item === null) {\n          if(key[0] === \"?\") val += this.indentate(level) + '<' + key + '?' + this.tagEndChar;\n          else val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\n          // val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\n        } else if (typeof item === 'object') {\n          val += this.processTextOrObjNode(item, key, level)\n        } else {\n          val += this.buildTextNode(item, key, '', level);\n        }\n      }\n    } else {\n      //nested node\n      if (this.options.attributesGroupName && key === this.options.attributesGroupName) {\n        const Ks = Object.keys(jObj[key]);\n        const L = Ks.length;\n        for (let j = 0; j < L; j++) {\n          attrStr += this.buildAttrPairStr(Ks[j], '' + jObj[key][Ks[j]]);\n        }\n      } else {\n        val += this.processTextOrObjNode(jObj[key], key, level)\n      }\n    }\n  }\n  return {attrStr: attrStr, val: val};\n};\n\nfunction buildAttrPairStr(attrName, val){\n  val = this.options.attributeValueProcessor(attrName, '' + val);\n  val = this.replaceEntitiesValue(val);\n  if (this.options.suppressBooleanAttributes && val === \"true\") {\n    return ' ' + attrName;\n  } else return ' ' + attrName + '=\"' + val + '\"';\n}\n\nfunction processTextOrObjNode (object, key, level) {\n  const result = this.j2x(object, level + 1);\n  if (object[this.options.textNodeName] !== undefined && Object.keys(object).length === 1) {\n    return this.buildTextNode(result.val, key, result.attrStr, level);\n  } else {\n    return this.buildObjNode(result.val, key, result.attrStr, level);\n  }\n}\n\nfunction buildObjectNode(val, key, attrStr, level) {\n  let tagEndExp = '</' + key + this.tagEndChar;\n  let piClosingChar = \"\";\n  \n  if(key[0] === \"?\") {\n    piClosingChar = \"?\";\n    tagEndExp = \"\";\n  }\n\n  if (attrStr && val.indexOf('<') === -1) {\n    return (\n      this.indentate(level) + '<' +  key + attrStr + piClosingChar + '>' +\n      val +\n      tagEndExp    );\n  } else {\n    return (\n      this.indentate(level) + '<' + key + attrStr + piClosingChar + this.tagEndChar +\n      val +\n      this.indentate(level) + tagEndExp    );\n  }\n}\n\nfunction buildEmptyObjNode(val, key, attrStr, level) {\n  if (val !== '') {\n    return this.buildObjectNode(val, key, attrStr, level);\n  } else {\n    if(key[0] === \"?\") return  this.indentate(level) + '<' + key + attrStr+ '?' + this.tagEndChar;\n    else return  this.indentate(level) + '<' + key + attrStr + '/' + this.tagEndChar;\n  }\n}\n\nfunction buildTextValNode(val, key, attrStr, level) {\n  const textValue = this.replaceEntitiesValue(val);\n\n  if( textValue === '' && this.options.unpairedTags.indexOf(key) !== -1){ //unpaired\n    if(this.options.suppressUnpairedNode){\n      return this.indentate(level) + '<' + key + this.tagEndChar;\n    }else{\n      return this.indentate(level) + '<' + key + \"/\" + this.tagEndChar;\n    }\n  }else{\n    return (\n      this.indentate(level) + '<' + key + attrStr + '>' +\n       textValue +\n      '</' + key + this.tagEndChar  );\n  }\n}\n\nfunction replaceEntitiesValue(textValue){\n  if(textValue && textValue.length > 0 && this.options.processEntities){\n    for (let i=0; i<this.options.entities.length; i++) {\n      const entity = this.options.entities[i];\n      textValue = textValue.replace(entity.regex, entity.val);\n    }\n  }\n  return textValue;\n}\n\nfunction buildEmptyTextNode(val, key, attrStr, level) {\n  if( val === '' && this.options.unpairedTags.indexOf(key) !== -1){ //unpaired\n    if(this.options.suppressUnpairedNode){\n      return this.indentate(level) + '<' + key + this.tagEndChar;\n    }else{\n      return this.indentate(level) + '<' + key + \"/\" + this.tagEndChar;\n    }\n  }else if (val !== '') { //empty\n    return this.buildTextValNode(val, key, attrStr, level);\n  } else {\n    if(key[0] === \"?\") return  this.indentate(level) + '<' + key + attrStr+ '?' + this.tagEndChar; //PI tag\n    else return  this.indentate(level) + '<' + key + attrStr + '/' + this.tagEndChar; //normal\n  }\n}\n\nfunction indentate(level) {\n  return this.options.indentBy.repeat(level);\n}\n\nfunction isAttribute(name /*, options*/) {\n  if (name.startsWith(this.options.attributeNamePrefix)) {\n    return name.substr(this.attrPrefixLen);\n  } else {\n    return false;\n  }\n}\n\nmodule.exports = Builder;\n"]},"metadata":{},"sourceType":"script"}
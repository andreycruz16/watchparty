{"ast":null,"code":"var _classCallCheck = require(\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _require = require(\"./OptionsBuilder\"),\n    buildOptions = _require.buildOptions;\n\nvar OrderedObjParser = require(\"./OrderedObjParser\");\n\nvar _require2 = require(\"./node2json\"),\n    prettify = _require2.prettify;\n\nvar validator = require('../validator');\n\nvar XMLParser = /*#__PURE__*/function () {\n  \"use strict\";\n\n  function XMLParser(options) {\n    _classCallCheck(this, XMLParser);\n\n    this.externalEntities = {};\n    this.options = buildOptions(options);\n  }\n  /**\n   * Parse XML dats to JS object \n   * @param {string|Buffer} xmlData \n   * @param {boolean|Object} validationOption \n   */\n\n\n  _createClass(XMLParser, [{\n    key: \"parse\",\n    value: function parse(xmlData, validationOption) {\n      if (typeof xmlData === \"string\") {} else if (xmlData.toString) {\n        xmlData = xmlData.toString();\n      } else {\n        throw new Error(\"XML data is accepted in String or Bytes[] form.\");\n      }\n\n      if (validationOption) {\n        if (validationOption === true) validationOption = {}; //validate with default options\n\n        var result = validator.validate(xmlData, validationOption);\n\n        if (result !== true) {\n          throw Error(\"\".concat(result.err.msg, \":\").concat(result.err.line, \":\").concat(result.err.col));\n        }\n      }\n\n      var orderedObjParser = new OrderedObjParser(this.options);\n      orderedObjParser.addExternalEntities(this.externalEntities);\n      var orderedResult = orderedObjParser.parseXml(xmlData);\n      if (this.options.preserveOrder || orderedResult === undefined) return orderedResult;else return prettify(orderedResult, this.options);\n    }\n    /**\n     * Add Entity which is not by default supported by this library\n     * @param {string} key \n     * @param {string} value \n     */\n\n  }, {\n    key: \"addEntity\",\n    value: function addEntity(key, value) {\n      if (value.indexOf(\"&\") !== -1) {\n        throw new Error(\"Entity value can't have '&'\");\n      } else if (key.indexOf(\"&\") !== -1 || key.indexOf(\";\") !== -1) {\n        throw new Error(\"An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'\");\n      } else {\n        this.externalEntities[key] = value;\n      }\n    }\n  }]);\n\n  return XMLParser;\n}();\n\nmodule.exports = XMLParser;","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/node_modules/fast-xml-parser/src/xmlparser/XMLParser.js"],"names":["require","buildOptions","OrderedObjParser","prettify","validator","XMLParser","options","externalEntities","xmlData","validationOption","toString","Error","result","validate","err","msg","line","col","orderedObjParser","addExternalEntities","orderedResult","parseXml","preserveOrder","undefined","key","value","indexOf","module","exports"],"mappings":";;;;AAAA,eAAwBA,OAAO,CAAC,kBAAD,CAA/B;AAAA,IAAQC,YAAR,YAAQA,YAAR;;AACA,IAAMC,gBAAgB,GAAGF,OAAO,CAAC,oBAAD,CAAhC;;AACA,gBAAoBA,OAAO,CAAC,aAAD,CAA3B;AAAA,IAAQG,QAAR,aAAQA,QAAR;;AACA,IAAMC,SAAS,GAAGJ,OAAO,CAAC,cAAD,CAAzB;;IAEMK,S;;;AAEF,qBAAYC,OAAZ,EAAoB;AAAA;;AAChB,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKD,OAAL,GAAeL,YAAY,CAACK,OAAD,CAA3B;AAEH;AACD;AACJ;AACA;AACA;AACA;;;;;WACI,eAAME,OAAN,EAAcC,gBAAd,EAA+B;AAC3B,UAAG,OAAOD,OAAP,KAAmB,QAAtB,EAA+B,CAC9B,CADD,MACM,IAAIA,OAAO,CAACE,QAAZ,EAAqB;AACvBF,QAAAA,OAAO,GAAGA,OAAO,CAACE,QAAR,EAAV;AACH,OAFK,MAED;AACD,cAAM,IAAIC,KAAJ,CAAU,iDAAV,CAAN;AACH;;AACD,UAAIF,gBAAJ,EAAqB;AACjB,YAAGA,gBAAgB,KAAK,IAAxB,EAA8BA,gBAAgB,GAAG,EAAnB,CADb,CACoC;;AAErD,YAAMG,MAAM,GAAGR,SAAS,CAACS,QAAV,CAAmBL,OAAnB,EAA4BC,gBAA5B,CAAf;;AACA,YAAIG,MAAM,KAAK,IAAf,EAAqB;AACnB,gBAAMD,KAAK,WAAKC,MAAM,CAACE,GAAP,CAAWC,GAAhB,cAAuBH,MAAM,CAACE,GAAP,CAAWE,IAAlC,cAA0CJ,MAAM,CAACE,GAAP,CAAWG,GAArD,EAAX;AACD;AACF;;AACH,UAAMC,gBAAgB,GAAG,IAAIhB,gBAAJ,CAAqB,KAAKI,OAA1B,CAAzB;AACAY,MAAAA,gBAAgB,CAACC,mBAAjB,CAAqC,KAAKZ,gBAA1C;AACA,UAAMa,aAAa,GAAGF,gBAAgB,CAACG,QAAjB,CAA0Bb,OAA1B,CAAtB;AACA,UAAG,KAAKF,OAAL,CAAagB,aAAb,IAA8BF,aAAa,KAAKG,SAAnD,EAA8D,OAAOH,aAAP,CAA9D,KACK,OAAOjB,QAAQ,CAACiB,aAAD,EAAgB,KAAKd,OAArB,CAAf;AACR;AAED;AACJ;AACA;AACA;AACA;;;;WACI,mBAAUkB,GAAV,EAAeC,KAAf,EAAqB;AACjB,UAAGA,KAAK,CAACC,OAAN,CAAc,GAAd,MAAuB,CAAC,CAA3B,EAA6B;AACzB,cAAM,IAAIf,KAAJ,CAAU,6BAAV,CAAN;AACH,OAFD,MAEM,IAAGa,GAAG,CAACE,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAtB,IAA2BF,GAAG,CAACE,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAApD,EAAsD;AACxD,cAAM,IAAIf,KAAJ,CAAU,sEAAV,CAAN;AACH,OAFK,MAED;AACD,aAAKJ,gBAAL,CAAsBiB,GAAtB,IAA6BC,KAA7B;AACH;AACJ;;;;;;AAGLE,MAAM,CAACC,OAAP,GAAiBvB,SAAjB","sourcesContent":["const { buildOptions} = require(\"./OptionsBuilder\");\nconst OrderedObjParser = require(\"./OrderedObjParser\");\nconst { prettify} = require(\"./node2json\");\nconst validator = require('../validator');\n\nclass XMLParser{\n    \n    constructor(options){\n        this.externalEntities = {};\n        this.options = buildOptions(options);\n        \n    }\n    /**\n     * Parse XML dats to JS object \n     * @param {string|Buffer} xmlData \n     * @param {boolean|Object} validationOption \n     */\n    parse(xmlData,validationOption){\n        if(typeof xmlData === \"string\"){\n        }else if( xmlData.toString){\n            xmlData = xmlData.toString();\n        }else{\n            throw new Error(\"XML data is accepted in String or Bytes[] form.\")\n        }\n        if( validationOption){\n            if(validationOption === true) validationOption = {}; //validate with default options\n            \n            const result = validator.validate(xmlData, validationOption);\n            if (result !== true) {\n              throw Error( `${result.err.msg}:${result.err.line}:${result.err.col}` )\n            }\n          }\n        const orderedObjParser = new OrderedObjParser(this.options);\n        orderedObjParser.addExternalEntities(this.externalEntities);\n        const orderedResult = orderedObjParser.parseXml(xmlData);\n        if(this.options.preserveOrder || orderedResult === undefined) return orderedResult;\n        else return prettify(orderedResult, this.options);\n    }\n\n    /**\n     * Add Entity which is not by default supported by this library\n     * @param {string} key \n     * @param {string} value \n     */\n    addEntity(key, value){\n        if(value.indexOf(\"&\") !== -1){\n            throw new Error(\"Entity value can't have '&'\")\n        }else if(key.indexOf(\"&\") !== -1 || key.indexOf(\";\") !== -1){\n            throw new Error(\"An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'\")\n        }else{\n            this.externalEntities[key] = value;\n        }\n    }\n}\n\nmodule.exports = XMLParser;"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"import _objectSpread from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import{debounce,getYouTubeResults,getStreamPathResults}from'../../utils';import{Dropdown}from'semantic-ui-react';import{YouTubeSearchResult,StreamPathSearchResult}from'../SearchResult/SearchResult';import{jsx as _jsx}from\"react/jsx-runtime\";export var SearchComponent=/*#__PURE__*/function(_React$Component){_inherits(SearchComponent,_React$Component);var _super=_createSuper(SearchComponent);function SearchComponent(){var _this;_classCallCheck(this,SearchComponent);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={results:[],resetDropdown:Number(new Date()),loading:false,lastResultTimestamp:Number(new Date()),inputMedia:undefined};_this.debounced=null;_this.doSearch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.persist();_this.setState({inputMedia:e.target.value},function(){if(!_this.debounced){_this.debounced=debounce(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var query,results,timestamp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});query=_this.state.inputMedia||'';results=[];timestamp=Number(new Date());if(!(_this.props.type==='youtube')){_context.next=10;break;}_context.next=7;return getYouTubeResults(query);case 7:results=_context.sent;_context.next=14;break;case 10:if(!(_this.props.type==='stream'&&_this.props.streamPath)){_context.next=14;break;}_context.next=13;return getStreamPathResults(_this.props.streamPath,query);case 13:results=_context.sent;case 14:if(timestamp>_this.state.lastResultTimestamp){_this.setState({loading:false,results:results,lastResultTimestamp:timestamp});}case 15:case\"end\":return _context.stop();}}},_callee);})),500);}_this.debounced();});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}();_this.setMedia=function(e,data){window.setTimeout(function(){return _this.setState({resetDropdown:Number(new Date())});},300);_this.props.setMedia(e,data);};return _this;}_createClass(SearchComponent,[{key:\"render\",value:function render(){var _this2=this;var setMedia=this.setMedia;var placeholder='[BETA] Search streams';var icon='film';if(this.props.type==='youtube'){placeholder='Search YouTube';icon='youtube';}if(this.state.loading){icon='loading circle notch';}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Dropdown,{fluid:true,style:{height:'36px'},button:true,icon:icon,className:\"icon\",labeled:true,disabled:this.props.disabled,search:function search(){},text:placeholder,onSearchChange:this.doSearch,scrolling:true// onBlur={() => this.setState({ results: this.state.watchOptions })}\n//searchQuery={this.state.query}\n//loading={this.state.loading}\n,children:Boolean(this.state.results.length)?/*#__PURE__*/_jsx(Dropdown.Menu,{children:this.state.results.map(function(result){if(_this2.props.type==='youtube'){return/*#__PURE__*/_jsx(YouTubeSearchResult,_objectSpread(_objectSpread({},result),{},{setMedia:setMedia,playlistAdd:_this2.props.playlistAdd}),result.url);}return/*#__PURE__*/_jsx(StreamPathSearchResult,_objectSpread(_objectSpread({},result),{},{setMedia:setMedia,launchMultiSelect:_this2.props.launchMultiSelect,streamPath:_this2.props.streamPath||''}),result.url);})}):null},this.state.resetDropdown)});}}]);return SearchComponent;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/SearchComponent/SearchComponent.tsx"],"names":["React","debounce","getYouTubeResults","getStreamPathResults","Dropdown","YouTubeSearchResult","StreamPathSearchResult","SearchComponent","state","results","resetDropdown","Number","Date","loading","lastResultTimestamp","inputMedia","undefined","debounced","doSearch","e","persist","setState","target","value","query","timestamp","props","type","streamPath","setMedia","data","window","setTimeout","placeholder","icon","height","disabled","Boolean","length","map","result","playlistAdd","url","launchMultiSelect","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { debounce, getYouTubeResults, getStreamPathResults } from '../../utils';\nimport { DropdownProps, Dropdown } from 'semantic-ui-react';\nimport {\n  YouTubeSearchResult,\n  StreamPathSearchResult,\n} from '../SearchResult/SearchResult';\n\ninterface SearchComponentProps {\n  setMedia: Function;\n  playlistAdd: Function;\n  type?: 'youtube' | 'media' | 'stream';\n  launchMultiSelect?: Function;\n  streamPath: string | undefined;\n  disabled?: boolean;\n}\n\nexport class SearchComponent extends React.Component<SearchComponentProps> {\n  state = {\n    results: [] as SearchResult[],\n    resetDropdown: Number(new Date()),\n    loading: false,\n    lastResultTimestamp: Number(new Date()),\n    inputMedia: undefined,\n  };\n  debounced: any = null;\n\n  doSearch = async (e: any) => {\n    e.persist();\n    this.setState({ inputMedia: e.target.value }, () => {\n      if (!this.debounced) {\n        this.debounced = debounce(async () => {\n          this.setState({ loading: true });\n          let query = this.state.inputMedia || '';\n          let results: SearchResult[] = [];\n          let timestamp = Number(new Date());\n          if (this.props.type === 'youtube') {\n            results = await getYouTubeResults(query);\n          } else if (this.props.type === 'stream' && this.props.streamPath) {\n            results = await getStreamPathResults(this.props.streamPath, query);\n          }\n          if (timestamp > this.state.lastResultTimestamp) {\n            this.setState({\n              loading: false,\n              results,\n              lastResultTimestamp: timestamp,\n            });\n          }\n        }, 500);\n      }\n      this.debounced();\n    });\n  };\n\n  setMedia = (e: any, data: DropdownProps) => {\n    window.setTimeout(\n      () => this.setState({ resetDropdown: Number(new Date()) }),\n      300\n    );\n    this.props.setMedia(e, data);\n  };\n\n  render() {\n    const setMedia = this.setMedia;\n    let placeholder = '[BETA] Search streams';\n    let icon = 'film';\n    if (this.props.type === 'youtube') {\n      placeholder = 'Search YouTube';\n      icon = 'youtube';\n    }\n    if (this.state.loading) {\n      icon = 'loading circle notch';\n    }\n    return (\n      <React.Fragment>\n        <Dropdown\n          key={this.state.resetDropdown}\n          fluid\n          style={{ height: '36px' }}\n          button\n          icon={icon}\n          className=\"icon\"\n          labeled\n          disabled={this.props.disabled}\n          search={(() => {}) as any}\n          text={placeholder}\n          onSearchChange={this.doSearch}\n          scrolling\n          // onBlur={() => this.setState({ results: this.state.watchOptions })}\n          //searchQuery={this.state.query}\n          //loading={this.state.loading}\n        >\n          {Boolean(this.state.results.length) ? (\n            <Dropdown.Menu>\n              {this.state.results.map((result: SearchResult) => {\n                if (this.props.type === 'youtube') {\n                  return (\n                    <YouTubeSearchResult\n                      key={result.url}\n                      {...result}\n                      setMedia={setMedia}\n                      playlistAdd={this.props.playlistAdd}\n                    />\n                  );\n                }\n                return (\n                  <StreamPathSearchResult\n                    key={result.url}\n                    {...result}\n                    setMedia={setMedia}\n                    launchMultiSelect={this.props.launchMultiSelect as Function}\n                    streamPath={this.props.streamPath || ''}\n                  />\n                );\n              })}\n            </Dropdown.Menu>\n          ) : null}\n        </Dropdown>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}